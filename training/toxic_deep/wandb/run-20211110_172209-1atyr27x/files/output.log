
[34m[1mwandb[39m[22m: [33mWARNING[39m Symlinked 4 files into the W&B run directory, call wandb.save again to sync new files.
/usr/local/lib/python3.6/dist-packages/numpy/lib/arraysetops.py:569: FutureWarning: elementwise comparison failed; returning scalar instead, but in the future will perform elementwise comparison
  mask |= (ar1 == a)
/usr/local/lib/python3.6/dist-packages/numpy/lib/arraysetops.py:569: FutureWarning: elementwise comparison failed; returning scalar instead, but in the future will perform elementwise comparison
  mask |= (ar1 == a)
/usr/local/lib/python3.6/dist-packages/torch/nn/modules/rnn.py:65: UserWarning: dropout option adds dropout after all but last recurrent layer, so non-zero dropout expects num_layers greater than 1, but got dropout=0.5 and num_layers=1
  "num_layers={}".format(dropout, num_layers))
1.009002
[59780, 38308]
LR:  0.001



























































Epoch: 0/99 Phase: train Loss: 0.4580 (0.4205) Acc: 0.7366 (0.8000) Rec 1: 0.7829 (0.7368): 100%|███████████| 767/767 [02:01<00:00,  6.31it/s]



















Epoch: 0/99 Phase: valid Loss: 0.3158 (0.3997) Acc: 0.8458 (0.6500) Rec 1: 0.6270 (0.0000):  96%|████████▋| 1178/1227 [00:39<00:01, 30.25it/s]
Epoch: 0/99 Phase: valid Loss: 0.3153 (0.5165) Acc: 0.8457 (0.5000) Rec 1: 0.6300 (nan): 100%|████████████| 1227/1227 [00:40<00:00, 30.22it/s]





























































Epoch: 1/99 Phase: train Loss: 0.3389 (0.2285) Acc: 0.8255 (0.9500) Rec 1: 0.8249 (1.0000): 100%|███████████| 767/767 [02:03<00:00,  6.21it/s]



















Epoch: 1/99 Phase: valid Loss: 0.2358 (0.0014) Acc: 0.8994 (1.0000) Rec 1: 0.5446 (nan): 100%|████████████| 1227/1227 [00:40<00:00, 30.17it/s]
Epoch: 2/99 Phase: train Loss: 0.3158 (0.4038) Acc: 0.8438 (0.7969) Rec 1: 0.7979 (0.7021):   1%|             | 4/767 [00:00<02:00,  6.35it/s]



























































Epoch: 2/99 Phase: train Loss: 0.3172 (0.2846) Acc: 0.8391 (0.9250) Rec 1: 0.8458 (1.0000): 100%|███████████| 767/767 [02:00<00:00,  6.36it/s]



















Epoch: 2/99 Phase: valid Loss: 0.2445 (0.3780) Acc: 0.8919 (0.8500) Rec 1: 0.6084 (nan):  95%|███████████▍| 1167/1227 [00:38<00:01, 30.41it/s]
Epoch: 2/99 Phase: valid Loss: 0.2443 (0.0080) Acc: 0.8912 (1.0000) Rec 1: 0.6091 (nan): 100%|████████████| 1227/1227 [00:40<00:00, 30.26it/s]




























































Epoch: 3/99 Phase: train Loss: 0.2973 (0.4370) Acc: 0.8529 (0.7750) Rec 1: 0.8538 (0.7222): 100%|███████████| 767/767 [02:01<00:00,  6.30it/s]



















Epoch: 3/99 Phase: valid Loss: 0.2488 (0.1514) Acc: 0.8872 (0.9500) Rec 1: 0.6980 (nan):  96%|███████████▌| 1183/1227 [00:39<00:01, 30.39it/s]
Epoch: 3/99 Phase: valid Loss: 0.2490 (0.0010) Acc: 0.8860 (1.0000) Rec 1: 0.6983 (nan): 100%|████████████| 1227/1227 [00:40<00:00, 30.21it/s]




























































Epoch: 4/99 Phase: train Loss: 0.2866 (0.2643) Acc: 0.8615 (0.8500) Rec 1: 0.8647 (0.8000): 100%|███████████| 767/767 [02:01<00:00,  6.33it/s]



















Epoch: 4/99 Phase: valid Loss: 0.2191 (0.0306) Acc: 0.9099 (1.0000) Rec 1: 0.6490 (nan): 100%|████████████| 1227/1227 [00:40<00:00, 30.34it/s]
Epoch: 5/99 Phase: train Loss: 0.2806 (0.3291) Acc: 0.8711 (0.8516) Rec 1: 0.8602 (0.8958):   1%|▏           | 10/767 [00:01<02:03,  6.12it/s]





























































Epoch: 5/99 Phase: train Loss: 0.2775 (0.2537) Acc: 0.8660 (0.8750) Rec 1: 0.8687 (0.8462): 100%|███████████| 767/767 [02:05<00:00,  6.12it/s]



















Epoch: 5/99 Phase: valid Loss: 0.2385 (0.0610) Acc: 0.8907 (1.0000) Rec 1: 0.7096 (1.0000):  97%|████████▋| 1191/1227 [00:39<00:01, 30.61it/s]
Epoch: 5/99 Phase: valid Loss: 0.2387 (0.0565) Acc: 0.8901 (1.0000) Rec 1: 0.7116 (nan): 100%|████████████| 1227/1227 [00:40<00:00, 30.38it/s]




























































Epoch: 6/99 Phase: train Loss: 0.2684 (0.2497) Acc: 0.8713 (0.8500) Rec 1: 0.8748 (0.8824): 100%|███████████| 767/767 [02:01<00:00,  6.30it/s]



















Epoch: 6/99 Phase: valid Loss: 0.2359 (0.2812) Acc: 0.8947 (0.8500) Rec 1: 0.7085 (1.0000):  97%|████████▊| 1195/1227 [00:39<00:01, 30.52it/s]
Epoch: 6/99 Phase: valid Loss: 0.2358 (0.1698) Acc: 0.8940 (1.0000) Rec 1: 0.7040 (nan): 100%|████████████| 1227/1227 [00:40<00:00, 30.31it/s]




























































Epoch: 7/99 Phase: train Loss: 0.2663 (0.2426) Acc: 0.8735 (0.9250) Rec 1: 0.8796 (1.0000): 100%|███████████| 767/767 [02:03<00:00,  6.21it/s]




















Epoch: 7/99 Phase: valid Loss: 0.2352 (0.1926) Acc: 0.8942 (0.9000) Rec 1: 0.7023 (nan):  99%|███████████▊| 1211/1227 [00:40<00:00, 30.52it/s]
Epoch: 7/99 Phase: valid Loss: 0.2349 (0.1032) Acc: 0.8938 (1.0000) Rec 1: 0.7021 (nan): 100%|████████████| 1227/1227 [00:40<00:00, 30.30it/s]



























































Epoch: 8/99 Phase: train Loss: 0.2592 (0.1958) Acc: 0.8778 (0.9000) Rec 1: 0.8823 (0.9286): 100%|███████████| 767/767 [02:01<00:00,  6.33it/s]



















Epoch: 8/99 Phase: valid Loss: 0.2181 (0.3000) Acc: 0.9048 (0.8000) Rec 1: 0.6911 (nan):  97%|███████████▋| 1193/1227 [00:39<00:01, 30.56it/s]
Epoch: 8/99 Phase: valid Loss: 0.2175 (0.0209) Acc: 0.9047 (1.0000) Rec 1: 0.6907 (nan): 100%|████████████| 1227/1227 [00:40<00:00, 30.39it/s]




























































Epoch: 9/99 Phase: train Loss: 0.2547 (0.2562) Acc: 0.8806 (0.8750) Rec 1: 0.8863 (0.8750): 100%|███████████| 767/767 [02:01<00:00,  6.34it/s]



















Epoch: 9/99 Phase: valid Loss: 0.2489 (0.2181) Acc: 0.8857 (0.9000) Rec 1: 0.7490 (nan):  98%|███████████▊| 1205/1227 [00:39<00:00, 30.14it/s]
Epoch: 9/99 Phase: valid Loss: 0.2486 (0.1582) Acc: 0.8850 (1.0000) Rec 1: 0.7419 (nan): 100%|████████████| 1227/1227 [00:40<00:00, 30.19it/s]




























































Epoch: 10/99 Phase: train Loss: 0.2488 (0.1738) Acc: 0.8825 (0.9000) Rec 1: 0.8892 (0.9286): 100%|██████████| 767/767 [02:02<00:00,  6.25it/s]




















Epoch: 10/99 Phase: valid Loss: 0.2282 (0.2485) Acc: 0.8985 (0.9500) Rec 1: 0.7132 (nan):  99%|██████████▉| 1214/1227 [00:41<00:00, 27.79it/s]
Epoch: 10/99 Phase: valid Loss: 0.2276 (0.0001) Acc: 0.8980 (1.0000) Rec 1: 0.7135 (nan): 100%|███████████| 1227/1227 [00:41<00:00, 29.59it/s]



































































Epoch: 11/99 Phase: train Loss: 0.2458 (0.2533) Acc: 0.8856 (0.9500) Rec 1: 0.8909 (1.0000): 100%|██████████| 767/767 [02:17<00:00,  5.59it/s]



















Epoch: 11/99 Phase: valid Loss: 0.2226 (0.1672) Acc: 0.9037 (0.9000) Rec 1: 0.7299 (nan):  97%|██████████▋| 1195/1227 [00:39<00:01, 30.55it/s]
Epoch: 11/99 Phase: valid Loss: 0.2232 (1.1222) Acc: 0.9029 (0.5000) Rec 1: 0.7268 (nan): 100%|███████████| 1227/1227 [00:40<00:00, 30.39it/s]




























































Epoch: 12/99 Phase: train Loss: 0.2437 (0.1380) Acc: 0.8879 (0.9250) Rec 1: 0.8952 (1.0000): 100%|██████████| 767/767 [02:01<00:00,  6.29it/s]



















Epoch: 12/99 Phase: valid Loss: 0.2009 (0.1029) Acc: 0.9162 (0.9500) Rec 1: 0.6829 (nan):  97%|██████████▋| 1186/1227 [00:39<00:01, 30.34it/s]
Epoch: 12/99 Phase: valid Loss: 0.2004 (0.2833) Acc: 0.9156 (1.0000) Rec 1: 0.6869 (nan): 100%|███████████| 1227/1227 [00:40<00:00, 30.29it/s]





























































Epoch: 13/99 Phase: train Loss: 0.2395 (0.1868) Acc: 0.8879 (0.9250) Rec 1: 0.8952 (0.9375): 100%|██████████| 767/767 [02:03<00:00,  6.20it/s]



















Epoch: 13/99 Phase: valid Loss: 0.2089 (0.0009) Acc: 0.9115 (1.0000) Rec 1: 0.7154 (nan): 100%|███████████| 1227/1227 [00:40<00:00, 30.28it/s]
Epoch: 14/99 Phase: train Loss: 0.2328 (0.2685) Acc: 0.9023 (0.8906) Rec 1: 0.8818 (0.8636):   1%|            | 6/767 [00:00<02:00,  6.30it/s]



























































Epoch: 14/99 Phase: train Loss: 0.2395 (0.4869) Acc: 0.8905 (0.7000) Rec 1: 0.8951 (0.6111): 100%|██████████| 767/767 [02:01<00:00,  6.33it/s]



















Epoch: 14/99 Phase: valid Loss: 0.1941 (0.2462) Acc: 0.9201 (1.0000) Rec 1: 0.6812 (nan): 100%|███████████| 1227/1227 [00:40<00:00, 30.38it/s]
Epoch: 15/99 Phase: train Loss: 0.2504 (0.2061) Acc: 0.9023 (0.9141) Rec 1: 0.8824 (0.9400):   0%|            | 2/767 [00:00<02:01,  6.30it/s]




























































Epoch: 15/99 Phase: train Loss: 0.2343 (0.2369) Acc: 0.8922 (0.9250) Rec 1: 0.8979 (0.9474): 100%|██████████| 767/767 [02:01<00:00,  6.30it/s]



















Epoch: 15/99 Phase: valid Loss: 0.2266 (0.6788) Acc: 0.9018 (0.5000) Rec 1: 0.7438 (nan): 100%|███████████| 1227/1227 [00:40<00:00, 30.16it/s]
  0%|                                                                                                                 | 0/767 [00:00<?, ?it/s]




























































Epoch: 16/99 Phase: train Loss: 0.2347 (0.3206) Acc: 0.8926 (0.8000) Rec 1: 0.8994 (0.9286): 100%|██████████| 767/767 [02:01<00:00,  6.32it/s]



















Epoch: 16/99 Phase: valid Loss: 0.1958 (0.0681) Acc: 0.9189 (1.0000) Rec 1: 0.6926 (nan):  97%|██████████▋| 1191/1227 [00:39<00:01, 30.38it/s]
Epoch: 16/99 Phase: valid Loss: 0.1967 (0.3980) Acc: 0.9180 (0.5000) Rec 1: 0.6907 (nan): 100%|███████████| 1227/1227 [00:40<00:00, 30.35it/s]






























































Epoch: 17/99 Phase: train Loss: 0.2307 (0.1817) Acc: 0.8940 (0.9250) Rec 1: 0.9001 (0.8667): 100%|██████████| 767/767 [02:05<00:00,  6.11it/s]



















Epoch: 17/99 Phase: valid Loss: 0.1868 (0.1462) Acc: 0.9203 (1.0000) Rec 1: 0.6831 (nan): 100%|███████████| 1227/1227 [00:40<00:00, 30.35it/s]
Epoch: 18/99 Phase: train Loss: 0.2500 (0.1887) Acc: 0.8906 (0.9297) Rec 1: 0.8710 (0.9412):   1%|▏          | 11/767 [00:01<02:00,  6.25it/s]



























































Epoch: 18/99 Phase: train Loss: 0.2269 (0.1808) Acc: 0.8961 (0.9250) Rec 1: 0.9028 (1.0000): 100%|██████████| 767/767 [02:02<00:00,  6.28it/s]




















Epoch: 18/99 Phase: valid Loss: 0.2473 (0.1924) Acc: 0.8881 (0.9500) Rec 1: 0.7654 (nan):  99%|██████████▉| 1215/1227 [00:39<00:00, 30.64it/s]
Epoch: 18/99 Phase: valid Loss: 0.2471 (0.5078) Acc: 0.8876 (1.0000) Rec 1: 0.7685 (nan): 100%|███████████| 1227/1227 [00:40<00:00, 30.43it/s]




























































Epoch: 19/99 Phase: train Loss: 0.2254 (0.2977) Acc: 0.8965 (0.9000) Rec 1: 0.9042 (0.9286): 100%|██████████| 767/767 [02:03<00:00,  6.20it/s]



















Epoch: 19/99 Phase: valid Loss: 0.1878 (0.1275) Acc: 0.9221 (0.9500) Rec 1: 0.6809 (nan):  96%|██████████▌| 1179/1227 [00:39<00:01, 30.49it/s]
Epoch: 19/99 Phase: valid Loss: 0.1869 (0.0031) Acc: 0.9217 (1.0000) Rec 1: 0.6831 (nan): 100%|███████████| 1227/1227 [00:40<00:00, 30.30it/s]




























































Epoch: 20/99 Phase: train Loss: 0.2255 (0.3690) Acc: 0.8973 (0.8000) Rec 1: 0.9032 (0.7857): 100%|██████████| 767/767 [02:01<00:00,  6.32it/s]



















Epoch: 20/99 Phase: valid Loss: 0.2002 (0.1461) Acc: 0.9144 (0.9500) Rec 1: 0.7315 (nan):  98%|██████████▋| 1198/1227 [00:39<00:00, 30.60it/s]
Epoch: 20/99 Phase: valid Loss: 0.2006 (0.4197) Acc: 0.9134 (1.0000) Rec 1: 0.7287 (nan): 100%|███████████| 1227/1227 [00:40<00:00, 30.38it/s]



























































Epoch: 21/99 Phase: train Loss: 0.2237 (0.1678) Acc: 0.8979 (0.9500) Rec 1: 0.9065 (1.0000): 100%|██████████| 767/767 [02:01<00:00,  6.30it/s]




















Epoch: 21/99 Phase: valid Loss: 0.1807 (0.1399) Acc: 0.9251 (0.9500) Rec 1: 0.6864 (nan):  99%|██████████▉| 1215/1227 [00:40<00:00, 30.37it/s]
Epoch: 21/99 Phase: valid Loss: 0.1805 (0.0125) Acc: 0.9244 (1.0000) Rec 1: 0.6888 (nan): 100%|███████████| 1227/1227 [00:40<00:00, 30.16it/s]



























































Epoch: 22/99 Phase: train Loss: 0.2229 (0.3441) Acc: 0.8982 (0.8000) Rec 1: 0.9075 (0.6429): 100%|██████████| 767/767 [02:01<00:00,  6.32it/s]



















Epoch: 22/99 Phase: valid Loss: 0.1574 (0.0520) Acc: 0.9365 (1.0000) Rec 1: 0.6509 (nan):  96%|██████████▌| 1175/1227 [00:38<00:01, 30.54it/s]
Epoch: 22/99 Phase: valid Loss: 0.1572 (0.1813) Acc: 0.9357 (1.0000) Rec 1: 0.6546 (nan): 100%|███████████| 1227/1227 [00:40<00:00, 30.35it/s]






























































Epoch: 23/99 Phase: train Loss: 0.2195 (0.2051) Acc: 0.9002 (0.9000) Rec 1: 0.9074 (0.9375): 100%|██████████| 767/767 [02:05<00:00,  6.11it/s]



















Epoch: 23/99 Phase: valid Loss: 0.2092 (0.3492) Acc: 0.9126 (0.9000) Rec 1: 0.7290 (nan):  97%|██████████▋| 1186/1227 [00:39<00:01, 30.52it/s]
Epoch: 23/99 Phase: valid Loss: 0.2090 (0.0574) Acc: 0.9119 (1.0000) Rec 1: 0.7268 (nan): 100%|███████████| 1227/1227 [00:40<00:00, 30.40it/s]




























































Epoch: 24/99 Phase: train Loss: 0.2172 (0.0878) Acc: 0.9019 (0.9750) Rec 1: 0.9068 (1.0000): 100%|██████████| 767/767 [02:01<00:00,  6.29it/s]



















Epoch: 24/99 Phase: valid Loss: 0.2000 (0.3464) Acc: 0.9158 (0.8500) Rec 1: 0.7192 (nan):  98%|██████████▊| 1202/1227 [00:39<00:00, 30.40it/s]
Epoch: 24/99 Phase: valid Loss: 0.1995 (0.0053) Acc: 0.9153 (1.0000) Rec 1: 0.7211 (nan): 100%|███████████| 1227/1227 [00:40<00:00, 30.34it/s]





























































Epoch: 25/99 Phase: train Loss: 0.2151 (0.1716) Acc: 0.9032 (0.9000) Rec 1: 0.9120 (0.8571): 100%|██████████| 767/767 [02:03<00:00,  6.21it/s]



















Epoch: 25/99 Phase: valid Loss: 0.1767 (0.1903) Acc: 0.9261 (0.9500) Rec 1: 0.7053 (nan): 100%|██████████▉| 1223/1227 [00:40<00:00, 30.39it/s]
Epoch: 25/99 Phase: valid Loss: 0.1765 (0.0326) Acc: 0.9255 (1.0000) Rec 1: 0.7059 (1.0000): 100%|████████| 1227/1227 [00:40<00:00, 30.29it/s]



























































Epoch: 26/99 Phase: train Loss: 0.2148 (0.4002) Acc: 0.9028 (0.8250) Rec 1: 0.9097 (0.8889): 100%|██████████| 767/767 [02:01<00:00,  6.33it/s]



















Epoch: 26/99 Phase: valid Loss: 0.2090 (0.2373) Acc: 0.9120 (0.9000) Rec 1: 0.7593 (1.0000):  97%|███████▋| 1186/1227 [00:39<00:01, 30.54it/s]
Epoch: 26/99 Phase: valid Loss: 0.2082 (0.0001) Acc: 0.9114 (1.0000) Rec 1: 0.7590 (nan): 100%|███████████| 1227/1227 [00:40<00:00, 30.38it/s]






























































Epoch: 27/99 Phase: train Loss: 0.2163 (0.1997) Acc: 0.9018 (0.9000) Rec 1: 0.9123 (0.8889): 100%|██████████| 767/767 [02:07<00:00,  6.02it/s]




















Epoch: 27/99 Phase: valid Loss: 0.2018 (0.0093) Acc: 0.9136 (1.0000) Rec 1: 0.7514 (nan): 100%|███████████| 1227/1227 [00:41<00:00, 29.47it/s]
Epoch: 28/99 Phase: train Loss: 0.1621 (0.1621) Acc: 0.9375 (0.9375) Rec 1: 0.9500 (0.9500):   0%|            | 1/767 [00:00<02:24,  5.31it/s]
































































Epoch: 28/99 Phase: train Loss: 0.2137 (0.1190) Acc: 0.9032 (0.9750) Rec 1: 0.9089 (0.9231): 100%|██████████| 767/767 [02:09<00:00,  5.93it/s]



















Epoch: 28/99 Phase: valid Loss: 0.2141 (0.1911) Acc: 0.9075 (0.9000) Rec 1: 0.7669 (nan):  98%|██████████▋| 1199/1227 [00:39<00:00, 30.42it/s]
Epoch: 28/99 Phase: valid Loss: 0.2133 (0.0022) Acc: 0.9072 (1.0000) Rec 1: 0.7666 (nan): 100%|███████████| 1227/1227 [00:40<00:00, 30.33it/s]






























































Epoch: 29/99 Phase: train Loss: 0.2106 (0.2789) Acc: 0.9051 (0.9000) Rec 1: 0.9123 (0.8000): 100%|██████████| 767/767 [02:05<00:00,  6.10it/s]



















Epoch: 29/99 Phase: valid Loss: 0.1926 (0.0614) Acc: 0.9206 (1.0000) Rec 1: 0.7072 (nan):  99%|██████████▉| 1218/1227 [00:40<00:00, 30.54it/s]
Epoch: 29/99 Phase: valid Loss: 0.1922 (0.0024) Acc: 0.9200 (1.0000) Rec 1: 0.7078 (nan): 100%|███████████| 1227/1227 [00:40<00:00, 30.33it/s]



























































Epoch: 30/99 Phase: train Loss: 0.2136 (0.2407) Acc: 0.9037 (0.8500) Rec 1: 0.9118 (0.7778): 100%|██████████| 767/767 [02:01<00:00,  6.29it/s]



















Epoch: 30/99 Phase: valid Loss: 0.1883 (0.2645) Acc: 0.9204 (1.0000) Rec 1: 0.7306 (nan): 100%|███████████| 1227/1227 [00:40<00:00, 30.29it/s]
Epoch: 31/99 Phase: train Loss: 0.1760 (0.1760) Acc: 0.9297 (0.9297) Rec 1: 0.9796 (0.9796):   0%|            | 1/767 [00:00<02:07,  6.02it/s]





























































Epoch: 31/99 Phase: train Loss: 0.2101 (0.1604) Acc: 0.9053 (0.9500) Rec 1: 0.9136 (1.0000): 100%|██████████| 767/767 [02:03<00:00,  6.21it/s]



















Epoch: 31/99 Phase: valid Loss: 0.2057 (0.0849) Acc: 0.9106 (0.9500) Rec 1: 0.7490 (nan):  97%|██████████▋| 1187/1227 [00:39<00:01, 30.59it/s]
Epoch: 31/99 Phase: valid Loss: 0.2068 (0.0045) Acc: 0.9093 (1.0000) Rec 1: 0.7495 (nan): 100%|███████████| 1227/1227 [00:40<00:00, 30.30it/s]




























































Epoch: 32/99 Phase: train Loss: 0.2039 (0.2918) Acc: 0.9086 (0.8500) Rec 1: 0.9165 (0.8235): 100%|██████████| 767/767 [02:01<00:00,  6.33it/s]



















Epoch: 32/99 Phase: valid Loss: 0.2082 (0.0440) Acc: 0.9119 (1.0000) Rec 1: 0.7471 (nan): 100%|██████████▉| 1223/1227 [00:40<00:00, 30.55it/s]
Epoch: 32/99 Phase: valid Loss: 0.2081 (0.1022) Acc: 0.9114 (1.0000) Rec 1: 0.7476 (nan): 100%|███████████| 1227/1227 [00:40<00:00, 30.43it/s]



























































Epoch: 33/99 Phase: train Loss: 0.1997 (0.3774) Acc: 0.9102 (0.8250) Rec 1: 0.9186 (0.9333): 100%|██████████| 767/767 [02:01<00:00,  6.30it/s]



















Epoch: 33/99 Phase: valid Loss: 0.2006 (0.0002) Acc: 0.9143 (1.0000) Rec 1: 0.7495 (nan): 100%|███████████| 1227/1227 [00:40<00:00, 30.18it/s]
Epoch: 34/99 Phase: train Loss: 0.1713 (0.1713) Acc: 0.9453 (0.9453) Rec 1: 0.9423 (0.9423):   0%|            | 1/767 [00:00<01:54,  6.68it/s]




























































Epoch: 34/99 Phase: train Loss: 0.1979 (0.1603) Acc: 0.9105 (0.9500) Rec 1: 0.9222 (1.0000): 100%|██████████| 767/767 [02:01<00:00,  6.32it/s]



















Epoch: 34/99 Phase: valid Loss: 0.1882 (0.4016) Acc: 0.9170 (0.5000) Rec 1: 0.7438 (nan): 100%|███████████| 1227/1227 [00:40<00:00, 30.33it/s]
Epoch: 35/99 Phase: train Loss: 0.2126 (0.2090) Acc: 0.9094 (0.9297) Rec 1: 0.9167 (0.8636):   1%|            | 5/767 [00:00<02:04,  6.13it/s]






























































Epoch: 35/99 Phase: train Loss: 0.1967 (0.2514) Acc: 0.9121 (0.9000) Rec 1: 0.9227 (0.8824): 100%|██████████| 767/767 [02:05<00:00,  6.11it/s]



















Epoch: 35/99 Phase: valid Loss: 0.1961 (0.2479) Acc: 0.9176 (0.9500) Rec 1: 0.7278 (1.0000):  98%|███████▊| 1202/1227 [00:39<00:00, 30.62it/s]
Epoch: 35/99 Phase: valid Loss: 0.1953 (0.0508) Acc: 0.9172 (1.0000) Rec 1: 0.7306 (nan): 100%|███████████| 1227/1227 [00:40<00:00, 30.39it/s]




























































Epoch: 36/99 Phase: train Loss: 0.1964 (0.1984) Acc: 0.9131 (0.9000) Rec 1: 0.9206 (0.9333): 100%|██████████| 767/767 [02:02<00:00,  6.29it/s]

Epoch: 36/99 Phase: valid Loss: 0.2052 (0.3173) Acc: 0.9157 (0.9000) Rec 1: 0.6724 (0.0000):  13%|█▏       | 162/1227 [00:05<00:35, 30.17it/s]
Traceback (most recent call last):
  File "train.py", line 327, in <module>
    criterion,
  File "train.py", line 89, in train
    seqs = seqs.to(device)
  File "/usr/local/lib/python3.6/dist-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/root/konst/ml-utils/training/toxic_deep/model.py", line 42, in forward
    elr_reg *= self.lam
  File "/usr/local/lib/python3.6/dist-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/usr/local/lib/python3.6/dist-packages/torch/nn/modules/rnn.py", line 680, in forward
    self.dropout, self.training, self.bidirectional, self.batch_first)

1.223709
Loaded: 7/7
LR:  0.00025



Epoch: 0/159 Phase: train Loss: 0.3302 (0.3034) Acc: 0.0747 (0.1347) Rec B-EMPLOYMENT: 0.9414 (0.9524): 100%|█| 86/86 [00:09<00:00,  9.11it/s]
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)








Epoch: 0/159 Phase: valid Loss: 0.4500 (0.5521) Acc: 0.0114 (0.1098) Rec B-EMPLOYMENT: 0.9526 (nan): 100%|██| 687/687 [00:14<00:00, 46.08it/s]
{'I-EMPLOYMENT_appended_data': 995}
LR:  0.00025
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)




Epoch: 1/159 Phase: train Loss: 0.3153 (0.2415) Acc: 0.0752 (0.1357) Rec B-EMPLOYMENT: 0.9458 (0.9762): 100%|█| 86/86 [00:09<00:00,  9.17it/s]
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)






Epoch: 1/159 Phase: valid Loss: 0.4564 (0.6206) Acc: 0.0114 (0.1734) Rec B-EMPLOYMENT: 0.9421 (1.0000):  89%|▉| 614/687 [00:14<00:01, 44.93it/
Epoch: 1/159 Phase: valid Loss: 0.4599 (0.5406) Acc: 0.0114 (0.1077) Rec B-EMPLOYMENT: 0.9443 (nan): 100%|██| 687/687 [00:15<00:00, 43.67it/s]
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)




Epoch: 2/159 Phase: train Loss: 0.3059 (0.2533) Acc: 0.0752 (0.1336) Rec B-EMPLOYMENT: 0.9490 (0.9683): 100%|█| 86/86 [00:09<00:00,  9.02it/s]
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)







Epoch: 2/159 Phase: valid Loss: 0.4544 (0.2379) Acc: 0.0114 (0.1563) Rec B-EMPLOYMENT: 0.9404 (1.0000):  92%|▉| 633/687 [00:14<00:01, 44.09it/
Epoch: 2/159 Phase: valid Loss: 0.4561 (0.5102) Acc: 0.0114 (0.1098) Rec B-EMPLOYMENT: 0.9421 (nan): 100%|██| 687/687 [00:15<00:00, 43.33it/s]
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)




Epoch: 3/159 Phase: train Loss: 0.3083 (0.2682) Acc: 0.0752 (0.1339) Rec B-EMPLOYMENT: 0.9425 (0.9841): 100%|█| 86/86 [00:09<00:00,  9.02it/s]
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)







Epoch: 3/159 Phase: valid Loss: 0.4586 (0.4623) Acc: 0.0114 (0.1308) Rec B-EMPLOYMENT: 0.9402 (nan):  95%|█▉| 655/687 [00:14<00:00, 45.95it/s]
Epoch: 3/159 Phase: valid Loss: 0.4604 (0.5346) Acc: 0.0114 (0.1098) Rec B-EMPLOYMENT: 0.9415 (nan): 100%|██| 687/687 [00:15<00:00, 43.65it/s]
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)




Epoch: 4/159 Phase: train Loss: 0.3062 (0.2785) Acc: 0.0754 (0.1325) Rec B-EMPLOYMENT: 0.9419 (0.9921): 100%|█| 86/86 [00:09<00:00,  8.82it/s]
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)







Epoch: 4/159 Phase: valid Loss: 0.4583 (0.7598) Acc: 0.0114 (0.1238) Rec B-EMPLOYMENT: 0.9403 (0.7143):  96%|▉| 660/687 [00:15<00:00, 44.94it/
Epoch: 4/159 Phase: valid Loss: 0.4587 (0.5460) Acc: 0.0114 (0.1098) Rec B-EMPLOYMENT: 0.9417 (nan): 100%|██| 687/687 [00:15<00:00, 43.48it/s]
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)




Epoch: 5/159 Phase: train Loss: 0.2975 (0.2208) Acc: 0.0756 (0.1350) Rec B-EMPLOYMENT: 0.9435 (0.9762): 100%|█| 86/86 [00:09<00:00,  9.04it/s]
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)








Epoch: 5/159 Phase: valid Loss: 0.4573 (0.5345) Acc: 0.0114 (0.1098) Rec B-EMPLOYMENT: 0.9418 (nan): 100%|██| 687/687 [00:16<00:00, 42.48it/s]
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
Epoch: 6/159 Phase: train Loss: 0.2978 (0.3455) Acc: 0.0761 (0.1329) Rec B-EMPLOYMENT: 0.9301 (0.9425):   6%|  | 5/86 [00:01<00:12,  6.35it/s]
{'I-EMPLOYMENT_appended_data': 684}




Epoch: 6/159 Phase: train Loss: 0.2801 (0.2486) Acc: 0.0760 (0.1339) Rec B-EMPLOYMENT: 0.9457 (0.9841): 100%|█| 86/86 [00:10<00:00,  8.44it/s]
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)







Epoch: 6/159 Phase: valid Loss: 0.4674 (0.6014) Acc: 0.0114 (0.1098) Rec B-EMPLOYMENT: 0.9431 (nan): 100%|██| 687/687 [00:15<00:00, 43.56it/s]
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
Epoch: 7/159 Phase: train Loss: 0.3035 (0.3915) Acc: 0.0756 (0.1183) Rec B-EMPLOYMENT: 0.9392 (0.9149):   9%|▏ | 8/86 [00:01<00:10,  7.72it/s]




Epoch: 7/159 Phase: train Loss: 0.2797 (0.2766) Acc: 0.0761 (0.1367) Rec B-EMPLOYMENT: 0.9449 (0.9286): 100%|█| 86/86 [00:09<00:00,  8.96it/s]
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)







Epoch: 7/159 Phase: valid Loss: 0.4617 (0.2944) Acc: 0.0114 (0.1312) Rec B-EMPLOYMENT: 0.9401 (1.0000):  99%|▉| 679/687 [00:15<00:00, 46.32it/
Epoch: 7/159 Phase: valid Loss: 0.4613 (0.5528) Acc: 0.0114 (0.1098) Rec B-EMPLOYMENT: 0.9404 (nan): 100%|██| 687/687 [00:15<00:00, 43.45it/s]
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)




Epoch: 8/159 Phase: train Loss: 0.2760 (0.2242) Acc: 0.0762 (0.1371) Rec B-EMPLOYMENT: 0.9455 (0.9603): 100%|█| 86/86 [00:10<00:00,  8.05it/s]
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)







Epoch: 8/159 Phase: valid Loss: 0.4620 (0.6132) Acc: 0.0114 (0.1098) Rec B-EMPLOYMENT: 0.9405 (nan): 100%|██| 687/687 [00:15<00:00, 43.39it/s]
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
Epoch: 9/159 Phase: train Loss: 0.2937 (0.3266) Acc: 0.0760 (0.1341) Rec B-EMPLOYMENT: 0.9120 (0.8544):   6%|  | 5/86 [00:01<00:14,  5.42it/s]




Epoch: 9/159 Phase: train Loss: 0.2793 (0.2338) Acc: 0.0760 (0.1376) Rec B-EMPLOYMENT: 0.9400 (0.9444): 100%|█| 86/86 [00:09<00:00,  8.86it/s]
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)







Epoch: 9/159 Phase: valid Loss: 0.4626 (0.9038) Acc: 0.0114 (0.1221) Rec B-EMPLOYMENT: 0.9398 (1.0000):  95%|▉| 655/687 [00:15<00:00, 37.54it/
Epoch: 9/159 Phase: valid Loss: 0.4639 (0.6241) Acc: 0.0114 (0.1098) Rec B-EMPLOYMENT: 0.9410 (nan): 100%|██| 687/687 [00:15<00:00, 43.44it/s]
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
Epoch: 10/159 Phase: train Loss: 0.2836 (0.1870) Acc: 0.0752 (0.1224) Rec B-EMPLOYMENT: 0.9551 (0.9597):  30%|▎| 26/86 [00:03<00:06,  9.44it/s
Epoch: 10/159 Phase: train Loss: 0.2902 (0.2665) Acc: 0.0755 (0.1486) Rec B-EMPLOYMENT: 0.9474 (0.9552):  51%|▌| 44/86 [00:05<00:04,  9.38it/s
Epoch: 10/159 Phase: train Loss: 0.2829 (0.3265) Acc: 0.0761 (0.1233) Rec B-EMPLOYMENT: 0.9458 (0.8991):  74%|▋| 64/86 [00:07<00:02,  9.61it/s
Epoch: 10/159 Phase: train Loss: 0.2783 (0.2895) Acc: 0.0764 (0.1162) Rec B-EMPLOYMENT: 0.9467 (0.8833):  97%|▉| 83/86 [00:09<00:00, 10.41it/s
Epoch: 10/159 Phase: valid Loss: 0.4585 (0.2942) Acc: 0.0115 (0.1147) Rec B-EMPLOYMENT: 0.9603 (1.0000):   5%| | 31/687 [00:00<00:19, 34.32it/
Epoch: 10/159 Phase: valid Loss: 0.4585 (0.2942) Acc: 0.0115 (0.1147) Rec B-EMPLOYMENT: 0.9603 (1.0000):   5%| | 31/687 [00:00<00:19, 34.32it/
Traceback (most recent call last):
  File "train.py", line 436, in <module>
    wandb,
  File "train.py", line 101, in train
    outputs = model(seqs)
  File "/usr/local/lib/python3.6/dist-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/root/konst/ml-utils/training/ner_employment/model.py", line 76, in forward
    out, (h,c) = self.bilstm(word_embedding) #'out' has dimension(batchsize, seq_len, 2*hidden_size)
  File "/usr/local/lib/python3.6/dist-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/usr/local/lib/python3.6/dist-packages/torch/nn/modules/rnn.py", line 680, in forward
    self.dropout, self.training, self.bidirectional, self.batch_first)
KeyboardInterrupt
Exception in thread Thread-34:
Traceback (most recent call last):
  File "/usr/lib/python3.6/threading.py", line 916, in _bootstrap_inner
    self.run()
  File "/usr/lib/python3.6/threading.py", line 864, in run
    self._target(*self._args, **self._kwargs)
  File "/usr/local/lib/python3.6/dist-packages/torch/utils/data/_utils/pin_memory.py", line 28, in _pin_memory_loop
    r = in_queue.get(timeout=MP_STATUS_CHECK_INTERVAL)
  File "/usr/lib/python3.6/multiprocessing/queues.py", line 113, in get
    return _ForkingPickler.loads(res)
  File "/usr/local/lib/python3.6/dist-packages/torch/multiprocessing/reductions.py", line 289, in rebuild_storage_fd
    fd = df.detach()
  File "/usr/lib/python3.6/multiprocessing/resource_sharer.py", line 57, in detach
    with _resource_sharer.get_connection(self._id) as conn:
  File "/usr/lib/python3.6/multiprocessing/resource_sharer.py", line 87, in get_connection
    c = Client(address, authkey=process.current_process().authkey)
  File "/usr/lib/python3.6/multiprocessing/connection.py", line 487, in Client
    c = SocketClient(address)
  File "/usr/lib/python3.6/multiprocessing/connection.py", line 614, in SocketClient
    s.connect(address)

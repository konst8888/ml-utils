
[34m[1mwandb[39m[22m: [33mWARNING[39m Symlinked 4 files into the W&B run directory, call wandb.save again to sync new files.
Vocab size:  103
Vocab size:  103
Epoch: 0/199 Phase: train Loss: 3.5942 (3.5942) Acc: 0.0234 (0.0234) Rec comedy: nan (nan):   0%|        | 1/1717 [00:00<11:49,  2.42it/s]
0.849537
[1447, 8259, 699, 5886, 65184, 2396, 31583, 1191, 37.6, 284, 23025, 3398, 6012, 30723, 2644, 6336, 1004, 1220, 2262, 2043, 313, 620, 1487, 1228, 2888, 925, 1041, 1123, 1106, 2972, 867, 736, 2735, 816, 213.0, 1994, 2646]














Epoch: 0/199 Phase: train Loss: 3.5627 (3.5269) Acc: 0.0089 (0.0000) Rec comedy: 0.0000 (nan):   4%|â–   | 71/1717 [00:28<11:21,  2.41it/s]










































































































































































Epoch: 0/199 Phase: train Loss: 3.5283 (3.4716) Acc: 0.0417 (0.0312) Rec comedy: 0.3265 (0.0000):  53%|â–Œ| 906/1717 [06:09<05:30,  2.46it/s



















































































Epoch: 0/199 Phase: train Loss: 3.5181 (3.4229) Acc: 0.0477 (0.1016) Rec comedy: 0.4133 (0.0000):  77%|â–Š| 1314/1717 [08:55<02:49,  2.38it/


















































































Epoch: 0/199 Phase: train Loss: 3.5093 (3.6139) Acc: 0.0482 (0.0678) Rec comedy: 0.4734 (nan): 100%|â–ˆâ–ˆ| 1717/1717 [11:41<00:00,  2.45it/s]






























































































































Epoch: 0/199 Phase: valid Loss: 3.5758 (3.6095) Acc: 0.0688 (0.0000) Rec comedy: 0.5106 (nan):  99%|â–ˆâ–‰| 2731/2748 [04:13<00:01, 10.87it/s]
Epoch: 0/199 Phase: valid Loss: 3.5773 (5.9777) Acc: 0.0687 (0.0000) Rec comedy: 0.5106 (nan): 100%|â–ˆâ–ˆ| 2748/2748 [04:14<00:00, 10.78it/s]


































































































Epoch: 1/199 Phase: train Loss: 3.4293 (3.3673) Acc: 0.0443 (0.0469) Rec comedy: 0.7667 (0.0000):  28%|â–Ž| 482/1717 [03:17<08:28,  2.43it/s





































































































Epoch: 1/199 Phase: train Loss: 3.4047 (3.4837) Acc: 0.0587 (0.0781) Rec comedy: 0.7429 (0.0000):  57%|â–Œ| 978/1717 [06:39<04:48,  2.56it/s























































































































Epoch: 1/199 Phase: train Loss: 3.3822 (2.7829) Acc: 0.0706 (0.1250) Rec comedy: 0.7076 (1.0000):  91%|â–‰| 1561/1717 [10:37<01:01,  2.52it/































Epoch: 1/199 Phase: train Loss: 3.3720 (3.0034) Acc: 0.0734 (0.1695) Rec comedy: 0.7181 (nan): 100%|â–ˆâ–ˆ| 1717/1717 [11:41<00:00,  2.45it/s]































































































































Epoch: 1/199 Phase: valid Loss: 3.3706 (2.7035) Acc: 0.0965 (0.1000) Rec comedy: 0.6596 (nan): 100%|â–ˆâ–‰| 2739/2748 [04:14<00:00, 10.60it/s]
Epoch: 1/199 Phase: valid Loss: 3.3700 (2.7475) Acc: 0.0964 (0.5000) Rec comedy: 0.6596 (nan): 100%|â–ˆâ–ˆ| 2748/2748 [04:15<00:00, 10.76it/s]








































Epoch: 2/199 Phase: train Loss: 3.2880 (3.0126) Acc: 0.1061 (0.1250) Rec comedy: 0.5455 (nan):  12%|â–Ž  | 200/1717 [01:21<10:36,  2.38it/s]













Epoch: 2/199 Phase: train Loss: 3.2916 (3.4858) Acc: 0.1048 (0.1094) Rec comedy: 0.6333 (nan):  15%|â–  | 264/1717 [01:47<10:01,  2.42it/s]


















































































Epoch: 2/199 Phase: train Loss: 3.2712 (3.4489) Acc: 0.1070 (0.1406) Rec comedy: 0.6377 (nan):  39%|â–ˆâ– | 665/1717 [04:31<06:56,  2.53it/s]






















































































































































































































Epoch: 2/199 Phase: train Loss: 3.2232 (3.1705) Acc: 0.1168 (0.1017) Rec comedy: 0.6223 (nan): 100%|â–ˆâ–ˆ| 1717/1717 [11:41<00:00,  2.45it/s]






























































































































Epoch: 2/199 Phase: valid Loss: 3.3776 (3.9112) Acc: 0.1141 (0.0000) Rec comedy: 0.2553 (nan): 100%|â–ˆâ–ˆ| 2748/2748 [04:15<00:00, 10.77it/s]
  0%|                                                                                                            | 0/1717 [00:00<?, ?it/s]
































































































Epoch: 3/199 Phase: train Loss: 3.1093 (3.1609) Acc: 0.1434 (0.1328) Rec comedy: 0.5593 (nan):  27%|â–Š  | 472/1717 [03:12<08:25,  2.46it/s]
































































Epoch: 3/199 Phase: train Loss: 3.0999 (3.2351) Acc: 0.1444 (0.1797) Rec comedy: 0.5244 (nan):  46%|â–ˆâ–Ž | 785/1717 [05:20<06:05,  2.55it/s]
Epoch: 3/199 Phase: train Loss: 3.1001 (3.2460) Acc: 0.1443 (0.1172) Rec comedy: 0.5244 (nan):  46%|â–ˆâ–Ž | 786/1717 [05:21<06:20,  2.45it/s]
Traceback (most recent call last):
  File "train.py", line 357, in <module>
    wandb,
  File "train.py", line 92, in train
    for idx, sample in pbar:
  File "/usr/local/lib/python3.6/dist-packages/tqdm/std.py", line 1185, in __iter__
    for obj in iterable:
  File "/usr/local/lib/python3.6/dist-packages/torch/utils/data/dataloader.py", line 521, in __next__
    data = self._next_data()
  File "/usr/local/lib/python3.6/dist-packages/torch/utils/data/dataloader.py", line 561, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
  File "/usr/local/lib/python3.6/dist-packages/torch/utils/data/_utils/fetch.py", line 44, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/usr/local/lib/python3.6/dist-packages/torch/utils/data/_utils/fetch.py", line 44, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/root/konst/ml-utils/training/tagger_text/dataset.py", line 181, in __getitem__
    ])
  File "/root/konst/ml-utils/training/tagger_text/dataset.py", line 181, in <listcomp>
    ])
KeyError: None